##Cargar los paquetes del R
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)

##Cargar los datos de expresión de genes
supervivencia<-read.table("C:/Users/Ruben/Desktop/Tesis/Resultados Tesis/supervivencia/supervivencia.txt", header=T, sep='\t')

##Definir los factores del experimento en nuestros datos
supervivencia$Genotype<-as.factor(supervivencia$Genotype)
supervivencia$Sucrose<-as.factor(supervivencia$Sucrose)
supervivencia$Sorbitol<-as.factor(supervivencia$Sorbitol)
supervivencia$Ascorbic_Acid<-as.factor(supervivencia$Ascorbic_Acid)

##Generar la tabla de datos de supervivencia
surv_object <- Surv(time = supervivencia$futime, event = supervivencia$fustat)
surv_object

##Generar el modelo fit.coxph en base a los 3 factores
fit.coxph <- coxph(surv_object ~ Genotype + Sucrose + Sorbitol + Ascorbic_Acid, 
                   data = supervivencia)
##Definir la gráfica a obtener
tiff('prueba.tiff', units="in", width=7, height=7, res=2000, compression = 'lzw')
ggforest(fit.coxph, data = supervivencia)
dev.off()
